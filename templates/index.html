<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gangsta</title>

  <style>
    body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  margin: 0;
  padding: 0;
  overflow: hidden;

  background-image: url("{{ url_for('static', filename='alley.jpeg') }}");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;

  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

    .card {
      width: 760px;
      border: none;
      border-radius: 20px;
      padding: 24px;
      text-align: center;
    }

h1 {
  margin-top: 0;
  font-size: 48px;
  color: #371111;
  text-shadow:
    0 0 5px #d85555,
    0 0 10px #892c2c,
    0 0 20px #bc2525,
    0 0 40px #b98080;
  animation: flicker 2s infinite;
}

/* Neon flicker animation */
@keyframes flicker {
  0%, 18%, 22%, 25%, 53%, 57%, 100% { opacity: 1; }
  20%, 24%, 55% { opacity: 0.4; }
}


    /* ===== STAGE ===== */
    #stage {
      position: relative;
      width: 700px;
      margin: 0 auto;
    }

    /* Wrap so overlays align to dog */
    #dogWrap {
      position: relative;
      width: 100%;
    }

    /* ===== BASE DOG ===== */
    #base {
      width: 68%;
      display: block;
      position: relative;
      z-index: 2;        /* dog in front of boombox */
      margin-left: 10px; /* slight left nudge */
    }

    /* Shared overlay behavior */
    .overlay {
      position: absolute;
      pointer-events: none;
    }

    /* ===== BOOMBOX PULSE ===== */
    @keyframes thump {
      0%   { transform: rotate(-4deg) scale(1); }
      50%  { transform: rotate(-4deg) scale(1.04); }
      100% { transform: rotate(-4deg) scale(1); }
    }

    #boombox.pulsing {
      animation: thump 0.35s infinite;
      transform-origin: center;
    }

    /* ===== OVERLAYS ===== */

    /* Boombox behind */
    #boombox {
      width: 55%;
      left: 55%;
      top: 50%;
      z-index: 1;          /* behind dog */
      transform: rotate(-4deg);
      opacity: 0.95;
    }

    /* Chain on top */
    #chain {
      width: 38%;
      left: 21%;
      top: 25%;
      z-index: 3;
    }

    /* Sunglasses on top */
    #sunglasses {
      width: 38%;
      left: 29%;
      top: 5%;
      z-index: 4;
      transform: rotate(-1deg);
    }

    /* Controls */
    .controls {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 16px;
    }

    .pill {
      padding: 8px 18px;
      border-radius: 999px;
      border: 1px solid #000;
      font-weight: 600;
    }

    button {
      padding: 8px 18px;
      border-radius: 999px;
      border: 1px solid #000;
      background: #fff;
      cursor: pointer;
    }

    button:hover {
      background: #f5f5f5;
    }
  </style>
</head>

<body>
  <div class="card">
    <h1>Gangsta</h1>

    <div id="stage">
      <div id="dogWrap">
        <!-- Boombox (behind) -->
        <img id="boombox" class="overlay" src="/static/boombox.png" hidden alt="Boombox">

        <!-- Dog -->
        <img id="base" src="/static/base.png" alt="Dog">

        <!-- Chain -->
        <img id="chain" class="overlay" src="/static/chain.png" hidden alt="Chain">

        <!-- Sunglasses -->
        <img id="sunglasses" class="overlay" src="/static/sunglasses.png" hidden alt="Sunglasses">
      </div>
    </div>

    <div class="controls">
      <div class="pill">Level: <span id="level">0</span></div>
      <button id="reset">Reset</button>
    </div>

    <audio id="music" src="/static/music.mp3"></audio>
  </div>

  <script>
    let level = 0;

    const chain = document.getElementById("chain");
    const sunglasses = document.getElementById("sunglasses");
    const boombox = document.getElementById("boombox");
    const music = document.getElementById("music");
    const levelDisplay = document.getElementById("level");
    const resetBtn = document.getElementById("reset");

    function updateLevel() {
      levelDisplay.textContent = level;
    }

    // Boombox pulse on/off based on music play state
    function updatePulse() {
      boombox.classList.toggle("pulsing", !music.paused);
    }

    music.addEventListener("play", updatePulse);
    music.addEventListener("pause", updatePulse);
    music.addEventListener("ended", updatePulse);

    function resetAll() {
      level = 0;
      chain.hidden = true;
      sunglasses.hidden = true;
      boombox.hidden = true;

      music.pause();
      music.currentTime = 0;

      updatePulse();
      updateLevel();
    }

    window.addEventListener("keydown", (e) => {
      if (e.key !== "Enter") return;
      e.preventDefault();

      level++;

      if (level === 1) chain.hidden = false;
      else if (level === 2) sunglasses.hidden = false;
      else if (level === 3) boombox.hidden = false;
      else if (level === 4) music.play();
      else {
        // After final level: toggle music play/pause
        if (music.paused) music.play();
        else music.pause();
      }

      updateLevel();
    });

    resetBtn.addEventListener("click", resetAll);

    // Initialize UI state
    updateLevel();
    updatePulse();
  </script>
</body>
</html>
